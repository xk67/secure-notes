{% extends "base.html" %}
{% load static %}

{% block extra_head %}
    <script src="{% static 'js/md-editor.js' %}"></script>
    <script src="{% static 'js/embed-consent.js' %}"></script>
    <style>
        .md-editor {
            width: 1000px;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            overflow: hidden;
        }

        .md-editor-toolbar {
            display: flex;
            background-color: #f6f8fa;
            padding: 0;
            gap: 0;
        }

        .md-editor-toolbar button {
            padding: 8px 16px;
            border: none;
            background-color: transparent;
            cursor: pointer;
            font-size: 14px;
            color: #24292f;
            opacity: 0.5;
            border-bottom: 1px solid #d0d7de;
            position: relative;
        }

        .md-editor-toolbar button:hover {
            opacity: 0.8;
        }

        .md-editor-toolbar button.active {
            opacity: 1;
            background-color: #ffffff;
            border-bottom: none;
        }

        .md-editor-toolbar .toolbar-spacer {
            flex-grow: 1;
            border-bottom: 1px solid #d0d7de;
        }

        .md-editor-content {
            width: 100%;
            height: 400px;
            box-sizing: border-box;
        }

        .md-editor #md-textarea {
            width: 100%;
            height: 400px;
            border: none;
            padding: 12px;
            font-family: monospace;
            font-size: 14px;
            resize: none;
            box-sizing: border-box;
            outline: none;
        }

        #preview-content {
            display: none;
            width: 100%;
            height: 400px;
            padding: 12px;
            overflow: auto;
            box-sizing: border-box;
            font-size: 14px;
            line-height: 1.5;
        }
    </style>
{% endblock %}

{% block header %}
{% include 'header.html' with title="Create Note" %}
{% endblock %}

{% block main %}
<a href="{% url 'notes:search_note' %}">Search Notes</a>
<br>
<a href="{% url 'notes:list_notes' %}">List Notes</a>

<form method="post">
    {% csrf_token %}

    <div>
        <label for="id_title">Title:</label><br>
        {{ form.title }}
        {% if form.title.errors %}
        <p style="color: red;">{{ form.title.errors.0 }}</p>
        {% endif %}
    </div>

    <div class="md-editor">
        <div class="md-editor-toolbar">
            <button type="button" id="button-write" class="active">Write</button>
            <button type="button" id="button-preview">Preview</button>
            <div class="toolbar-spacer"></div>
        </div>
        <div class="md-editor-content">
            {{ form.content }}
            <div id="preview-content"></div>
        </div>
        {% if form.content.errors %}
        <p style="color: red;">{{ form.content.errors.0 }}</p>
        {% endif %}
    </div>

    <div>
        {{ form.private }}
        <label for="id_private">Private</label>
    </div>

    <button type="submit">Create note</button>

    {% if note_url %}
    <p>View your created note: <a href="{{ note_url }}">{{ note_url }}</a></p>
    {% endif %}
</form>
{% endblock %}
